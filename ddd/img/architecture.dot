digraph architecture {
    splines=false
    subgraph cluster_domain{
        node[style=filled;fillcolor=white]
        edge[color=blue];
        app[label="应用程序";style="rounded,filled";shape=box;fillcolor="#66ccff"]
        o[label="领域对象";shape=circle]
        repo[label="资源库(Repo)";shape=cylinder];
        d_ser[label="领域服务"];

        
        app->repo
        app->o
        app->d_ser
        labelloc=b;
        label="领域";
        fontsize=20;
        style=filled;
        fillcolor="#ffff80";
        out[style=invisible;rank=min]
        
    }

    edge[head=invis;headport=w]
    d_ser->in
    repo->in
    edge[headport=none]
    subgraph cluster_infr{
        in[style=invisible;rank=same;height=0;width=0]
        node[style=filled;fillcolor=white]
        db[label="数据库";shape=cylinder]
        mq[label="消息中间件"]
        ex_ser[label="外部服务"];
        edge[style=invis];
        _r[style=invis;]
        
        in->db,mq,ex_ser
        
        fontsize=20;
        label="基础设施";
        style=filled;
        fillcolor="#ff6600";
    }

    subgraph cluster_entry{
        node[style=filled;fillcolor=white]
        a2[label="Thrift适配器";shape=box;width=1];
        
        a0[label="HTTP适配器";shape=octagon];
        a1[label="Dubbo适配器";shape=diamond;height=1];

        a2->app;    
        a0->app;
        a1->app;
        fontsize=20;
        label="访问入口";
        style=filled;
        shape=oval;
        fillcolor="#ccffcc";       
    }



    fontsize=20
    label="一个可能的 DDD 架构";
}

